"use strict";(self.webpackChunknestjs_mod_com=self.webpackChunknestjs_mod_com||[]).push([[4296],{5845:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>a,toc:()=>c});var s=t(4848),i=t(8453);const r={},o="\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 Postgres \u0432 \u043f\u0440\u043e\u0435\u043a\u0442 \u0438 \u0437\u0430\u043f\u0443\u0441\u043a \u043c\u0438\u0433\u0440\u0430\u0446\u0438\u0439 \u0447\u0435\u0440\u0435\u0437 Flyway \u0434\u043b\u044f NestJS-mod \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f",a={id:"ru-posts/fullstack/2024-08-11",title:"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 Postgres \u0432 \u043f\u0440\u043e\u0435\u043a\u0442 \u0438 \u0437\u0430\u043f\u0443\u0441\u043a \u043c\u0438\u0433\u0440\u0430\u0446\u0438\u0439 \u0447\u0435\u0440\u0435\u0437 Flyway \u0434\u043b\u044f NestJS-mod \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f",description:"\u0411\u0430\u0437\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0431\u0443\u0434\u0435\u0442 \u043f\u043e\u0434\u043d\u0438\u043c\u0430\u0442\u044c\u0441\u044f \u0447\u0435\u0440\u0435\u0437 Docker Compose.",source:"@site/docs/ru-posts/fullstack/2024-08-11.md",sourceDirName:"ru-posts/fullstack",slug:"/ru-posts/fullstack/2024-08-11",permalink:"/docs/ru-posts/fullstack/2024-08-11",draft:!1,unlisted:!1,editUrl:"https://github.com/nestjs-mod/nestjs-mod.com/blob/master/docs/ru-posts/fullstack/2024-08-11.md",tags:[],version:"current",frontMatter:{},sidebar:"ruPostsSidebar",previous:{title:"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u0443\u0441\u0442\u043e\u0433\u043e Angular \u043f\u0440\u043e\u0435\u043a\u0442\u0430 \u0438 \u0441\u0432\u044f\u0437\u044c \u0435\u0433\u043e \u0441 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u043c \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c \u043d\u0430 NestJS",permalink:"/docs/ru-posts/fullstack/2024-08-09"},next:{title:"\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 PrismaORM \u0432 NestJS-mod \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0435\u0433\u043e \u0440\u0430\u0431\u043e\u0442\u044b \u0447\u0435\u0440\u0435\u0437 REST",permalink:"/docs/ru-posts/fullstack/2024-08-13"}},d={},c=[{value:"1. \u0423\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c \u043f\u0430\u043a\u0435\u0442 \u0434\u043b\u044f \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 Docker Compose \u0438 Flyway \u0444\u0430\u0439\u043b\u043e\u0432",id:"1-\u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c-\u043f\u0430\u043a\u0435\u0442-\u0434\u043b\u044f-\u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438-docker-compose-\u0438-flyway-\u0444\u0430\u0439\u043b\u043e\u0432",level:3},{value:"2. \u0414\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043d\u044b\u0435 \u043c\u043e\u0434\u0443\u043b\u0438 \u0432 \u0441\u0435\u0440\u0432\u0435\u0440\u043d\u044b\u0439 \u043a\u043e\u0434",id:"2-\u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c-\u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043d\u044b\u0435-\u043c\u043e\u0434\u0443\u043b\u0438-\u0432-\u0441\u0435\u0440\u0432\u0435\u0440\u043d\u044b\u0439-\u043a\u043e\u0434",level:3},{value:"3. \u0421\u043e\u0437\u0434\u0430\u0435\u043c \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044e \u043f\u043e \u043f\u0440\u043e\u0435\u043a\u0442\u0443 \u0438 \u043f\u0430\u0440\u0430\u043b\u043b\u0435\u043b\u044c\u043d\u043e \u0441\u043e\u0437\u0434\u0430\u0435\u043c \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043a\u043e\u0434 \u0438 \u0441\u043a\u0440\u0438\u043f\u0442\u044b \u0434\u043b\u044f Docker Compose \u0438 Flyway",id:"3-\u0441\u043e\u0437\u0434\u0430\u0435\u043c-\u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044e-\u043f\u043e-\u043f\u0440\u043e\u0435\u043a\u0442\u0443-\u0438-\u043f\u0430\u0440\u0430\u043b\u043b\u0435\u043b\u044c\u043d\u043e-\u0441\u043e\u0437\u0434\u0430\u0435\u043c-\u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439-\u043a\u043e\u0434-\u0438-\u0441\u043a\u0440\u0438\u043f\u0442\u044b-\u0434\u043b\u044f-docker-compose-\u0438-flyway",level:3},{value:"4. \u0417\u0430\u043f\u043e\u043b\u043d\u044f\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f",id:"4-\u0437\u0430\u043f\u043e\u043b\u043d\u044f\u0435\u043c-\u043d\u043e\u0432\u044b\u0435-\u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435-\u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f",level:3},{value:"5. \u041f\u043e\u0432\u0442\u043e\u0440\u043d\u043e \u043f\u0435\u0440\u0435\u0441\u043e\u0437\u0434\u0430\u0435\u043c \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044e \u043f\u043e \u043f\u0440\u043e\u0435\u043a\u0442\u0443 \u0438 \u043f\u0430\u0440\u0430\u043b\u043b\u0435\u043b\u044c\u043d\u043e \u043f\u0435\u0440\u0435\u0441\u043e\u0437\u0434\u0430\u0435\u043c \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043a\u043e\u0434 \u0438 \u0441\u043a\u0440\u0438\u043f\u0442\u044b \u0434\u043b\u044f Docker Compose \u0438 Flyway",id:"5-\u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e-\u043f\u0435\u0440\u0435\u0441\u043e\u0437\u0434\u0430\u0435\u043c-\u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044e-\u043f\u043e-\u043f\u0440\u043e\u0435\u043a\u0442\u0443-\u0438-\u043f\u0430\u0440\u0430\u043b\u043b\u0435\u043b\u044c\u043d\u043e-\u043f\u0435\u0440\u0435\u0441\u043e\u0437\u0434\u0430\u0435\u043c-\u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439-\u043a\u043e\u0434-\u0438-\u0441\u043a\u0440\u0438\u043f\u0442\u044b-\u0434\u043b\u044f-docker-compose-\u0438-flyway",level:3},{value:"6. \u041a\u043e\u043f\u0438\u0440\u0443\u0435\u043c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b \u0441 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u043c\u0438 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u043f\u0440\u0438\u043c\u0435\u0440\u0430",id:"6-\u043a\u043e\u043f\u0438\u0440\u0443\u0435\u043c-\u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0439-\u0444\u0430\u0439\u043b-\u0441-\u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u043c\u0438-\u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f-\u0432-\u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435-\u043f\u0440\u0438\u043c\u0435\u0440\u0430",level:3},{value:"7. \u0421\u043e\u0437\u0434\u0430\u0435\u043c \u043c\u0438\u0433\u0440\u0430\u0446\u0438\u044e \u0441 \u043f\u0440\u0438\u043c\u0435\u0440\u043e\u043c \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0442\u0430\u0431\u043b\u0438\u0446\u044b",id:"7-\u0441\u043e\u0437\u0434\u0430\u0435\u043c-\u043c\u0438\u0433\u0440\u0430\u0446\u0438\u044e-\u0441-\u043f\u0440\u0438\u043c\u0435\u0440\u043e\u043c-\u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f-\u0442\u0430\u0431\u043b\u0438\u0446\u044b",level:3},{value:"8. \u041e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u043c sql \u0441\u043a\u0440\u0438\u043f\u0442 \u043f\u043e \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044e \u0434\u0435\u043c\u043e \u0442\u0430\u0431\u043b\u0438\u0446\u044b",id:"8-\u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u043c-sql-\u0441\u043a\u0440\u0438\u043f\u0442-\u043f\u043e-\u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044e-\u0434\u0435\u043c\u043e-\u0442\u0430\u0431\u043b\u0438\u0446\u044b",level:3},{value:"9. \u0417\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u043c \u0431\u0430\u0437\u0443 \u0434\u0430\u043d\u043d\u044b\u0445",id:"9-\u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u043c-\u0431\u0430\u0437\u0443-\u0434\u0430\u043d\u043d\u044b\u0445",level:3},{value:"10. \u0417\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u043c \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0431\u0430\u0437 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439",id:"10-\u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u043c-\u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435-\u0431\u0430\u0437-\u0434\u0430\u043d\u043d\u044b\u0445-\u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439",level:3},{value:"11. \u041f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u043c \u043c\u0438\u0433\u0440\u0430\u0446\u0438\u0438",id:"11-\u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u043c-\u043c\u0438\u0433\u0440\u0430\u0446\u0438\u0438",level:3},{value:"12. \u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u043c\u0441\u044f \u043a \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0441\u043f\u0438\u0441\u043e\u043a \u0442\u0430\u0431\u043b\u0438\u0446",id:"12-\u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u043c\u0441\u044f-\u043a-\u0431\u0430\u0437\u0435-\u0434\u0430\u043d\u043d\u044b\u0445-\u0438-\u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c-\u0441\u043f\u0438\u0441\u043e\u043a-\u0442\u0430\u0431\u043b\u0438\u0446",level:3},{value:"13. \u041e\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c \u0431\u0430\u0437\u0443 \u0434\u0430\u043d\u043d\u044b\u0445",id:"13-\u043e\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c-\u0431\u0430\u0437\u0443-\u0434\u0430\u043d\u043d\u044b\u0445",level:3},{value:"\u0421\u0441\u044b\u043b\u043a\u0438",id:"\u0441\u0441\u044b\u043b\u043a\u0438",level:3}];function l(e){const n={a:"a",code:"code",em:"em",h1:"h1",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"\u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435-\u0431\u0430\u0437\u044b-\u0434\u0430\u043d\u043d\u044b\u0445-postgres-\u0432-\u043f\u0440\u043e\u0435\u043a\u0442-\u0438-\u0437\u0430\u043f\u0443\u0441\u043a-\u043c\u0438\u0433\u0440\u0430\u0446\u0438\u0439-\u0447\u0435\u0440\u0435\u0437-flyway-\u0434\u043b\u044f-nestjs-mod-\u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f",children:"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 Postgres \u0432 \u043f\u0440\u043e\u0435\u043a\u0442 \u0438 \u0437\u0430\u043f\u0443\u0441\u043a \u043c\u0438\u0433\u0440\u0430\u0446\u0438\u0439 \u0447\u0435\u0440\u0435\u0437 Flyway \u0434\u043b\u044f NestJS-mod \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f"}),"\n",(0,s.jsx)(n.p,{children:"\u0411\u0430\u0437\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0431\u0443\u0434\u0435\u0442 \u043f\u043e\u0434\u043d\u0438\u043c\u0430\u0442\u044c\u0441\u044f \u0447\u0435\u0440\u0435\u0437 Docker Compose."}),"\n",(0,s.jsx)(n.p,{children:"\u041c\u0438\u0433\u0440\u0430\u0446\u0438\u0438 \u043f\u0438\u0448\u0443\u0442\u0441\u044f \u0432\u0440\u0443\u0447\u043d\u0443\u044e \u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u044e\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 Flyway \u043c\u0438\u0433\u0440\u0430\u0442\u043e\u0440."}),"\n",(0,s.jsx)(n.p,{children:"\u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0438\u043c\u0435\u0435\u0442 \u0441\u0432\u043e\u0439 \u043b\u043e\u0433\u0438\u043d \u0438 \u043f\u0430\u0440\u043e\u043b\u044c, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043e\u0442\u043b\u0438\u0447\u0430\u0435\u0442\u0441\u044f \u043e\u0442 \u0440\u0443\u0442\u043e\u0432\u043e\u0433\u043e."}),"\n",(0,s.jsx)(n.p,{children:"\u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0434\u043b\u044f Docker Compose \u0438 Flyway \u0433\u0435\u043d\u0435\u0440\u0438\u0440\u0443\u044e\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 \u0437\u0430\u043f\u0443\u0441\u043a NestJS-mod \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b."}),"\n",(0,s.jsx)(n.h3,{id:"1-\u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c-\u043f\u0430\u043a\u0435\u0442-\u0434\u043b\u044f-\u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438-docker-compose-\u0438-flyway-\u0444\u0430\u0439\u043b\u043e\u0432",children:"1. \u0423\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c \u043f\u0430\u043a\u0435\u0442 \u0434\u043b\u044f \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 Docker Compose \u0438 Flyway \u0444\u0430\u0439\u043b\u043e\u0432"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"\u041a\u043e\u043c\u0430\u043d\u0434\u044b"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Install all need dependencies\nnpm i --save @nestjs-mod/docker-compose @nestjs-mod/flyway\n\n# Install all need dev-dependencies\nnpm i --save-dev node-flywaydb@3.0.7\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"\u0412\u044b\u0432\u043e\u0434 \u043a\u043e\u043d\u0441\u043e\u043b\u0438"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ npm i --save @nestjs-mod/docker-compose @nestjs-mod/flyway\n\nadded 41 packages, and audited 2484 packages in 23s\n\n299 packages are looking for funding\n  run `npm fund` for details\n\n14 vulnerabilities (4 moderate, 10 high)\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nTo address all issues (including breaking changes), run:\n  npm audit fix --force\n\nRun `npm audit` for details.\n\n$ npm i --save-dev node-flywaydb@3.0.7\n\nadded 15 packages, and audited 2499 packages in 6s\n\n300 packages are looking for funding\n  run `npm fund` for details\n\n16 vulnerabilities (6 moderate, 10 high)\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nTo address all issues (including breaking changes), run:\n  npm audit fix --force\n\nRun `npm audit` for details.\n"})}),"\n",(0,s.jsx)(n.h3,{id:"2-\u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c-\u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043d\u044b\u0435-\u043c\u043e\u0434\u0443\u043b\u0438-\u0432-\u0441\u0435\u0440\u0432\u0435\u0440\u043d\u044b\u0439-\u043a\u043e\u0434",children:"2. \u0414\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043d\u044b\u0435 \u043c\u043e\u0434\u0443\u043b\u0438 \u0432 \u0441\u0435\u0440\u0432\u0435\u0440\u043d\u044b\u0439 \u043a\u043e\u0434"}),"\n",(0,s.jsx)(n.p,{children:"\u041e\u043d\u0438 \u0431\u0443\u0434\u0443\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u043d\u044b \u0434\u043b\u044f \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 \u0438 \u0441\u043a\u0440\u0438\u043f\u0442\u043e\u0432."}),"\n",(0,s.jsxs)(n.p,{children:["\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b ",(0,s.jsx)(n.code,{children:"apps/server/src/main.ts"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { DefaultNestApplicationInitializer, DefaultNestApplicationListener, InfrastructureMarkdownReportGenerator, PACKAGE_JSON_FILE, ProjectUtils, bootstrapNestApplication, isInfrastructureMode } from '@nestjs-mod/common';\nimport { DOCKER_COMPOSE_FILE, DockerCompose, DockerComposePostgreSQL } from '@nestjs-mod/docker-compose'; // <--\nimport { FLYWAY_JS_CONFIG_FILE, Flyway } from '@nestjs-mod/flyway'; // <--\nimport { NestjsPinoLoggerModule } from '@nestjs-mod/pino';\nimport { ECOSYSTEM_CONFIG_FILE, Pm2 } from '@nestjs-mod/pm2';\nimport { TerminusHealthCheckModule } from '@nestjs-mod/terminus';\nimport { MemoryHealthIndicator } from '@nestjs/terminus';\nimport { join } from 'path';\nimport { AppModule } from './app/app.module';\n\nconst appFeatureName = 'app'; // <--\nconst rootFolder = join(__dirname, '..', '..', '..');\nconst appFolder = join(rootFolder, 'apps', 'server');\n\nbootstrapNestApplication({\n  modules: {\n    system: [\n      ProjectUtils.forRoot({\n        staticConfiguration: {\n          applicationPackageJsonFile: join(appFolder, PACKAGE_JSON_FILE),\n          packageJsonFile: join(rootFolder, PACKAGE_JSON_FILE),\n          envFile: join(rootFolder, '.env'),\n        },\n      }),\n      DefaultNestApplicationInitializer.forRoot({\n        staticConfiguration: { bufferLogs: true },\n      }),\n      NestjsPinoLoggerModule.forRoot(),\n      TerminusHealthCheckModule.forRootAsync({\n        configurationFactory: (memoryHealthIndicator: MemoryHealthIndicator) => ({\n          standardHealthIndicators: [\n            {\n              name: 'memory_heap',\n              check: () => memoryHealthIndicator.checkHeap('memory_heap', 150 * 1024 * 1024),\n            },\n          ],\n        }),\n        inject: [MemoryHealthIndicator],\n      }),\n      DefaultNestApplicationListener.forRoot({\n        staticConfiguration: {\n          // When running in infrastructure mode, the backend server does not start.\n          mode: isInfrastructureMode() ? 'silent' : 'listen',\n        },\n      }),\n    ],\n    feature: [AppModule.forRoot()],\n    infrastructure: [\n      InfrastructureMarkdownReportGenerator.forRoot({\n        staticConfiguration: {\n          markdownFile: join(appFolder, 'INFRASTRUCTURE.MD'),\n          skipEmptySettings: true,\n        },\n      }),\n      Pm2.forRoot({\n        configuration: {\n          ecosystemConfigFile: join(rootFolder, ECOSYSTEM_CONFIG_FILE),\n          applicationScriptFile: join('dist/apps/server/main.js'),\n        },\n      }),\n      DockerCompose.forRoot({\n        // <--\n        configuration: {\n          dockerComposeFileVersion: '3',\n          dockerComposeFile: join(appFolder, DOCKER_COMPOSE_FILE),\n        },\n      }),\n      DockerComposePostgreSQL.forRoot(), // <--\n      DockerComposePostgreSQL.forFeature({\n        // <--\n        featureModuleName: appFeatureName,\n      }),\n      Flyway.forRoot({\n        // <--\n        staticConfiguration: {\n          featureName: appFeatureName,\n          migrationsFolder: join(appFolder, 'src', 'migrations'),\n          configFile: join(rootFolder, FLYWAY_JS_CONFIG_FILE),\n        },\n      }),\n    ],\n  },\n});\n"})}),"\n",(0,s.jsx)(n.h3,{id:"3-\u0441\u043e\u0437\u0434\u0430\u0435\u043c-\u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044e-\u043f\u043e-\u043f\u0440\u043e\u0435\u043a\u0442\u0443-\u0438-\u043f\u0430\u0440\u0430\u043b\u043b\u0435\u043b\u044c\u043d\u043e-\u0441\u043e\u0437\u0434\u0430\u0435\u043c-\u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439-\u043a\u043e\u0434-\u0438-\u0441\u043a\u0440\u0438\u043f\u0442\u044b-\u0434\u043b\u044f-docker-compose-\u0438-flyway",children:"3. \u0421\u043e\u0437\u0434\u0430\u0435\u043c \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044e \u043f\u043e \u043f\u0440\u043e\u0435\u043a\u0442\u0443 \u0438 \u043f\u0430\u0440\u0430\u043b\u043b\u0435\u043b\u044c\u043d\u043e \u0441\u043e\u0437\u0434\u0430\u0435\u043c \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043a\u043e\u0434 \u0438 \u0441\u043a\u0440\u0438\u043f\u0442\u044b \u0434\u043b\u044f Docker Compose \u0438 Flyway"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"\u041a\u043e\u043c\u0430\u043d\u0434\u044b"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Build all applications and library\nnpm run build\n\n# Generate markdown report\nnpm run docs:infrastructure\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"\u0412\u044b\u0432\u043e\u0434 \u043a\u043e\u043d\u0441\u043e\u043b\u0438"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'$ npm run build\n\n> @nestjs-mod-fullstack/source@0.0.0 build\n> npm run generate && npm run tsc:lint && ./node_modules/.bin/nx run-many --exclude=@nestjs-mod-fullstack/source --all -t=build --skip-nx-cache=true\n\n\n> @nestjs-mod-fullstack/source@0.0.0 generate\n> ./node_modules/.bin/nx run-many --exclude=@nestjs-mod-fullstack/source --all -t=generate --skip-nx-cache=true && npm run make-ts-list && npm run lint:fix\n\n NX   Successfully ran target generate for 0 projects (29ms)\n\n\n> @nestjs-mod-fullstack/source@0.0.0 make-ts-list\n> ./node_modules/.bin/rucken make-ts-list\n\n\n> @nestjs-mod-fullstack/source@0.0.0 lint:fix\n> npm run tsc:lint && ./node_modules/.bin/nx run-many --exclude=@nestjs-mod-fullstack/source --all -t=lint --fix\n\n\n> @nestjs-mod-fullstack/source@0.0.0 tsc:lint\n> ./node_modules/.bin/tsc --noEmit -p tsconfig.base.json\n\n\n   \u2714  nx run server-e2e:lint  [existing outputs match the cache, left as is]\n   \u2714  nx run server:lint (1s)\n   \u2714  nx run client:lint (1s)\n\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n\n NX   Successfully ran target lint for 3 projects (1s)\n\n      With additional flags:\n        --fix=true\n\nNx read the output from the cache instead of running the command for 1 out of 3 tasks.\n\n\n> @nestjs-mod-fullstack/source@0.0.0 tsc:lint\n> ./node_modules/.bin/tsc --noEmit -p tsconfig.base.json\n\n\n   \u2714  nx run server:build:production (3s)\n   \u2714  nx run client:build:production (15s)\n\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n\n NX   Successfully ran target build for 2 projects (15s)\n\n $ npm run docs:infrastructure\n\n> @nestjs-mod-fullstack/source@0.0.0 docs:infrastructure\n> export NESTJS_MODE=infrastructure && ./node_modules/.bin/nx run-many --exclude=@nestjs-mod-fullstack/source --all -t=start --parallel=1\n\n\n NX   Running target start for project server:\n\n- server\n\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n\n> nx run server:start\n\n> node dist/apps/server/main.js\n\n[22:07:23.987] INFO (491733): Starting Nest application...\n    context: "NestFactory"\n[22:07:23.987] INFO (491733): DefaultNestApp dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.987] INFO (491733): ProjectUtilsSettings dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.987] INFO (491733): DefaultNestApplicationInitializerSettings dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.987] INFO (491733): DefaultNestApplicationInitializerShared dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.987] INFO (491733): NestjsPinoLoggerModuleSettings dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.987] INFO (491733): NestjsPinoLoggerModuleShared dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.987] INFO (491733): TerminusHealthCheckModuleSettings dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.987] INFO (491733): DefaultNestApplicationListenerSettings dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.987] INFO (491733): DefaultNestApplicationListenerShared dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.987] INFO (491733): AppModuleSettings dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): AppModuleShared dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): InfrastructureMarkdownReportGeneratorSettings dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): Pm2Settings dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): Pm2Shared dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): ProjectUtils dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): DockerComposeSettings dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): ProjectUtils dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): DockerComposePostgreSQLSettings dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): DockerCompose dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): DockerComposePostgreSQL dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): DockerComposePostgreSQLSettings dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): DockerComposePostgreSQLShared dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): FlywaySettings dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): FlywayShared dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): InfrastructureMarkdownReportGeneratorSettings dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): ProjectUtils dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): InfrastructureMarkdownReportStorage dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): InfrastructureMarkdownReportStorageSettings dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): ProjectUtils dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): DockerCompose dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): FlywaySettings dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): FlywayShared dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): ProjectUtils dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): DefaultNestApplicationListenerSettings dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): DefaultNestApplicationListenerShared dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): DockerComposeShared dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): InfrastructureMarkdownReportStorageShared dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): AppModule dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): ProjectUtils dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): DefaultNestApplicationInitializer dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): DefaultNestApplicationListener dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): InfrastructureMarkdownReportGenerator dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): DockerComposePostgreSQL dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): Flyway dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): DefaultNestApplicationListener dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): NestjsPinoLoggerModule dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): TerminusModule dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): TerminusModule dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): ProjectUtilsShared dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): InfrastructureMarkdownReportGeneratorShared dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): Pm2 dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): DockerCompose dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): DockerComposePostgreSQL dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): InfrastructureMarkdownReportGeneratorShared dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): Flyway dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): InfrastructureMarkdownReportGenerator dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): LoggerModule dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): DockerComposePostgreSQLShared dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): TerminusHealthCheckModuleShared dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.988] INFO (491733): TerminusHealthCheckModule dependencies initialized\n    context: "InstanceLoader"\n[22:07:23.996] INFO (491733): TerminusHealthCheckController {/health}:\n    context: "RoutesResolver"\n[22:07:23.997] INFO (491733): Mapped {/health, GET} route\n    context: "RouterExplorer"\n[22:07:23.997] INFO (491733): AppController {/}:\n    context: "RoutesResolver"\n[22:07:23.997] INFO (491733): Mapped {/, GET} route\n    context: "RouterExplorer"\n[22:07:24.010] DEBUG (491733):\n    0: "SERVER_ROOT_DATABASE_URL: Description=\'Connection string for PostgreSQL with root credentials (example: postgres://postgres:postgres_password@localhost:5432/postgres?schema=public, username must be \\"postgres\\")\', Original Name=\'rootDatabaseUrl\'"\n    1: "SERVER_PORT: Description=\'The port on which to run the server.\', Default=\'3000\', Original Name=\'port\'"\n    2: "SERVER_HOSTNAME: Description=\'Hostname on which to listen for incoming packets.\', Original Name=\'hostname\'"\n    3: "SERVER_APP_DATABASE_URL: Description=\'Connection string for PostgreSQL with module credentials (example: postgres://feat:feat_password@localhost:5432/feat?schema=public)\', Original Name=\'databaseUrl\'"\n    context: "All application environments"\n[22:07:24.027] INFO (491733): Nest application successfully started\n    context: "NestApplication"\n\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n\n NX   Successfully ran target start for project server\n'})}),"\n",(0,s.jsx)(n.h3,{id:"4-\u0437\u0430\u043f\u043e\u043b\u043d\u044f\u0435\u043c-\u043d\u043e\u0432\u044b\u0435-\u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435-\u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f",children:"4. \u0417\u0430\u043f\u043e\u043b\u043d\u044f\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f"}),"\n",(0,s.jsxs)(n.p,{children:["\u041f\u043e\u0441\u043b\u0435 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u043d\u043e\u0433\u043e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u044b \u0432 \u0444\u0430\u0439\u043b\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f \u043f\u043e\u044f\u0432\u044f\u0442\u0441\u044f \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435, \u043f\u0440\u0438\u043c\u0435\u0440\u044b \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439 \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0432 \u043e\u0442\u0447\u0435\u0442\u0435 \u043f\u043e \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0435 ",(0,s.jsx)(n.code,{children:"apps/server/INFRASTRUCTURE.MD"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b ",(0,s.jsx)(n.code,{children:".env"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"SERVER_PORT=3000\nSERVER_ROOT_DATABASE_URL=postgres://postgres:postgres_password@localhost:5432/postgres?schema=public\nSERVER_APP_DATABASE_URL=postgres://app:app_password@localhost:5432/app?schema=public\n# server-postgre-sql (generated)\nSERVER_POSTGRE_SQL_POSTGRESQL_USERNAME=postgres\nSERVER_POSTGRE_SQL_POSTGRESQL_PASSWORD=postgres_password\nSERVER_POSTGRE_SQL_POSTGRESQL_DATABASE=postgres\n"})}),"\n",(0,s.jsx)(n.h3,{id:"5-\u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e-\u043f\u0435\u0440\u0435\u0441\u043e\u0437\u0434\u0430\u0435\u043c-\u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044e-\u043f\u043e-\u043f\u0440\u043e\u0435\u043a\u0442\u0443-\u0438-\u043f\u0430\u0440\u0430\u043b\u043b\u0435\u043b\u044c\u043d\u043e-\u043f\u0435\u0440\u0435\u0441\u043e\u0437\u0434\u0430\u0435\u043c-\u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439-\u043a\u043e\u0434-\u0438-\u0441\u043a\u0440\u0438\u043f\u0442\u044b-\u0434\u043b\u044f-docker-compose-\u0438-flyway",children:"5. \u041f\u043e\u0432\u0442\u043e\u0440\u043d\u043e \u043f\u0435\u0440\u0435\u0441\u043e\u0437\u0434\u0430\u0435\u043c \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044e \u043f\u043e \u043f\u0440\u043e\u0435\u043a\u0442\u0443 \u0438 \u043f\u0430\u0440\u0430\u043b\u043b\u0435\u043b\u044c\u043d\u043e \u043f\u0435\u0440\u0435\u0441\u043e\u0437\u0434\u0430\u0435\u043c \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043a\u043e\u0434 \u0438 \u0441\u043a\u0440\u0438\u043f\u0442\u044b \u0434\u043b\u044f Docker Compose \u0438 Flyway"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"\u041a\u043e\u043c\u0430\u043d\u0434\u044b"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Generate markdown report\nnpm run docs:infrastructure\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"\u0412\u044b\u0432\u043e\u0434 \u043a\u043e\u043d\u0441\u043e\u043b\u0438"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'$ npm run docs:infrastructure\n\n> @nestjs-mod-fullstack/source@0.0.0 docs:infrastructure\n> export NESTJS_MODE=infrastructure && ./node_modules/.bin/nx run-many --exclude=@nestjs-mod-fullstack/source --all -t=start --parallel=1\n\n\n NX   Running target start for project server:\n\n- server\n\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n\n> nx run server:start\n\n> node dist/apps/server/main.js\n\n[22:22:53.712] INFO (493825): Starting Nest application...\n    context: "NestFactory"\n[22:22:53.712] INFO (493825): DefaultNestApp dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): ProjectUtilsSettings dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): DefaultNestApplicationInitializerSettings dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): DefaultNestApplicationInitializerShared dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): NestjsPinoLoggerModuleSettings dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): NestjsPinoLoggerModuleShared dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): TerminusHealthCheckModuleSettings dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): DefaultNestApplicationListenerSettings dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): DefaultNestApplicationListenerShared dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): AppModuleSettings dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): AppModuleShared dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): InfrastructureMarkdownReportGeneratorSettings dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): Pm2Settings dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): Pm2Shared dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): ProjectUtils dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): DockerComposeSettings dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): ProjectUtils dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): DockerComposePostgreSQLSettings dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): DockerCompose dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): DockerComposePostgreSQL dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): DockerComposePostgreSQLSettings dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): DockerComposePostgreSQLShared dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): FlywaySettings dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): FlywayShared dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): InfrastructureMarkdownReportGeneratorSettings dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): ProjectUtils dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): InfrastructureMarkdownReportStorage dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): InfrastructureMarkdownReportStorageSettings dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): ProjectUtils dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): DockerCompose dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): FlywaySettings dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.712] INFO (493825): FlywayShared dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): ProjectUtils dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): DefaultNestApplicationListenerSettings dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): DefaultNestApplicationListenerShared dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): DockerComposeShared dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): InfrastructureMarkdownReportStorageShared dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): AppModule dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): ProjectUtils dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): DefaultNestApplicationInitializer dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): DefaultNestApplicationListener dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): InfrastructureMarkdownReportGenerator dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): DockerComposePostgreSQL dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): Flyway dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): DefaultNestApplicationListener dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): NestjsPinoLoggerModule dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): TerminusModule dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): TerminusModule dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): ProjectUtilsShared dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): InfrastructureMarkdownReportGeneratorShared dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): Pm2 dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): DockerCompose dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): DockerComposePostgreSQL dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): InfrastructureMarkdownReportGeneratorShared dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): Flyway dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): InfrastructureMarkdownReportGenerator dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): LoggerModule dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): DockerComposePostgreSQLShared dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): TerminusHealthCheckModuleShared dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.713] INFO (493825): TerminusHealthCheckModule dependencies initialized\n    context: "InstanceLoader"\n[22:22:53.720] INFO (493825): TerminusHealthCheckController {/health}:\n    context: "RoutesResolver"\n[22:22:53.721] INFO (493825): Mapped {/health, GET} route\n    context: "RouterExplorer"\n[22:22:53.721] INFO (493825): AppController {/}:\n    context: "RoutesResolver"\n[22:22:53.722] INFO (493825): Mapped {/, GET} route\n    context: "RouterExplorer"\n[22:22:53.735] DEBUG (493825):\n    0: "SERVER_ROOT_DATABASE_URL: Description=\'Connection string for PostgreSQL with root credentials (example: postgres://postgres:postgres_password@localhost:5432/postgres?schema=public, username must be \\"postgres\\")\', Original Name=\'rootDatabaseUrl\'"\n    1: "SERVER_PORT: Description=\'The port on which to run the server.\', Default=\'3000\', Original Name=\'port\'"\n    2: "SERVER_HOSTNAME: Description=\'Hostname on which to listen for incoming packets.\', Original Name=\'hostname\'"\n    3: "SERVER_APP_DATABASE_URL: Description=\'Connection string for PostgreSQL with module credentials (example: postgres://feat:feat_password@localhost:5432/feat?schema=public)\', Original Name=\'databaseUrl\'"\n    context: "All application environments"\n[22:22:53.759] INFO (493825): Nest application successfully started\n    context: "NestApplication"\n\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n\n NX   Successfully ran target start for project server\n'})}),"\n",(0,s.jsx)(n.h3,{id:"6-\u043a\u043e\u043f\u0438\u0440\u0443\u0435\u043c-\u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0439-\u0444\u0430\u0439\u043b-\u0441-\u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u043c\u0438-\u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f-\u0432-\u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435-\u043f\u0440\u0438\u043c\u0435\u0440\u0430",children:"6. \u041a\u043e\u043f\u0438\u0440\u0443\u0435\u043c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b \u0441 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u043c\u0438 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u043f\u0440\u0438\u043c\u0435\u0440\u0430"}),"\n",(0,s.jsx)(n.p,{children:"\u0422\u0430\u043a \u043a\u0430\u043a \u0444\u0430\u0439\u043b \u0441 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u043c\u0438 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f \u043d\u0430\u0445\u043e\u0434\u0442\u0441\u044f \u043f\u043e\u0434 gitignore, \u0442\u043e \u043f\u0440\u0438 \u043a\u043b\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u043f\u0443\u0441\u0442\u043e\u0433\u043e \u043f\u0440\u043e\u0435\u043a\u0442\u0430 \u043d\u0443\u0436\u043d\u043e \u0437\u0430\u043d\u043e\u0432\u043e \u0432\u0432\u043e\u0434\u0438\u0442\u044c \u0432\u0441\u0435 \u0437\u043d\u0430\u0435\u0447\u043d\u0438\u044f \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f, \u0434\u043b\u044f \u0431\u044b\u0441\u0442\u0440\u043e\u0433\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u043f\u0440\u043e\u0435\u043a\u0442\u0430 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0438\u043c\u0435\u0442\u044c \u043f\u0440\u0438\u043c\u0435\u0440 \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u043e\u0433\u043e \u0444\u0430\u0439\u043b \u0441 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u043c\u0438 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"\u041a\u043e\u043c\u0430\u043d\u0434\u044b"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cp -r ./.env ./example.env\n"})}),"\n",(0,s.jsx)(n.h3,{id:"7-\u0441\u043e\u0437\u0434\u0430\u0435\u043c-\u043c\u0438\u0433\u0440\u0430\u0446\u0438\u044e-\u0441-\u043f\u0440\u0438\u043c\u0435\u0440\u043e\u043c-\u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f-\u0442\u0430\u0431\u043b\u0438\u0446\u044b",children:"7. \u0421\u043e\u0437\u0434\u0430\u0435\u043c \u043c\u0438\u0433\u0440\u0430\u0446\u0438\u044e \u0441 \u043f\u0440\u0438\u043c\u0435\u0440\u043e\u043c \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0442\u0430\u0431\u043b\u0438\u0446\u044b"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"\u041a\u043e\u043c\u0430\u043d\u0434\u044b"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Create migrations folder\nmkdir -p ./apps/server/src/migrations\n\n# Create empty migration\nnpm run flyway:create:server\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"\u0412\u044b\u0432\u043e\u0434 \u043a\u043e\u043d\u0441\u043e\u043b\u0438"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ npm run flyway:create:server\n\n> @nestjs-mod-fullstack/source@0.0.0 flyway:create:server\n> ./node_modules/.bin/nx run server:flyway-create-migration\n\n\n> nx run server:flyway-create-migration\n\n> echo 'select 1;' > ./apps/server/src/migrations/V`date +%Y%m%d%H%M`__NewMigration.sql\n\n\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n\n NX   Successfully ran target flyway-create-migration for project server (42ms)\n\n\n NX   Nx detected a flaky task\n\n  server:flyway-create-migration\n\nFlaky tasks can disrupt your CI pipeline. Automatically retry them with Nx Cloud. Learn more at https://nx.dev/ci/features/flaky-tasks\n"})}),"\n",(0,s.jsx)(n.h3,{id:"8-\u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u043c-sql-\u0441\u043a\u0440\u0438\u043f\u0442-\u043f\u043e-\u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044e-\u0434\u0435\u043c\u043e-\u0442\u0430\u0431\u043b\u0438\u0446\u044b",children:"8. \u041e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u043c sql \u0441\u043a\u0440\u0438\u043f\u0442 \u043f\u043e \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044e \u0434\u0435\u043c\u043e \u0442\u0430\u0431\u043b\u0438\u0446\u044b"}),"\n",(0,s.jsxs)(n.p,{children:["\u0424\u0430\u0439\u043b \u043c\u0438\u0433\u0440\u0430\u0446\u0438\u0438 ",(0,s.jsx)(n.code,{children:"apps/server/src/migrations/V202408112241__NewMigration.sql"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:'CREATE TABLE IF NOT EXISTS "AppDemo"(\n    id uuid DEFAULT uuid_generate_v4() NOT NULL,\n    "name" varchar(128) NOT NULL,\n    "createdAt" timestamp DEFAULT "now"() NOT NULL,\n    "updatedAt" timestamp DEFAULT "now"() NOT NULL,\n    CONSTRAINT "PK_APP_DEMO" PRIMARY KEY (id)\n);\n\nCREATE UNIQUE INDEX IF NOT EXISTS "UQ_APP_DEMO" ON "AppDemo"("name");\n'})}),"\n",(0,s.jsx)(n.h3,{id:"9-\u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u043c-\u0431\u0430\u0437\u0443-\u0434\u0430\u043d\u043d\u044b\u0445",children:"9. \u0417\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u043c \u0431\u0430\u0437\u0443 \u0434\u0430\u043d\u043d\u044b\u0445"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"\u041a\u043e\u043c\u0430\u043d\u0434\u044b"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm run docker-compose:start-prod:server\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"\u0412\u044b\u0432\u043e\u0434 \u043a\u043e\u043d\u0441\u043e\u043b\u0438"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'$ npm run docker-compose:start-prod:server\n\n> @nestjs-mod-fullstack/source@0.0.0 docker-compose:start-prod:server\n> export COMPOSE_INTERACTIVE_NO_CLI=1 && docker-compose -f ./apps/server/docker-compose-prod.yml --env-file ./apps/server/docker-compose-prod.env --compatibility up -d\n\nCreating network "server_server-network" with driver "bridge"\nPulling server-postgre-sql (bitnami/postgresql:15.5.0)...\n15.5.0: Pulling from bitnami/postgresql\nc9b6a72ca844: Pull complete\nDigest: sha256:6887635cc793826e1e177d0cee151a878baa6747e37389252e89b034a30f04bc\nStatus: Downloaded newer image for bitnami/postgresql:15.5.0\nCreating server-postgre-sql ... done\n'})}),"\n",(0,s.jsx)(n.h3,{id:"10-\u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u043c-\u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435-\u0431\u0430\u0437-\u0434\u0430\u043d\u043d\u044b\u0445-\u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439",children:"10. \u0417\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u043c \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0431\u0430\u0437 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"\u041a\u043e\u043c\u0430\u043d\u0434\u044b"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm run db:create\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"\u0412\u044b\u0432\u043e\u0434 \u043a\u043e\u043d\u0441\u043e\u043b\u0438"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ npm run db:create\n\n> @nestjs-mod-fullstack/source@0.0.0 db:create\n> ./node_modules/.bin/nx run-many -t=db-create\n\n\n   \u2714  nx run server:db-create (787ms)\n\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n\n NX   Successfully ran target db-create for project server (819ms)\n\n\n NX   Nx detected a flaky task\n\n  server:db-create\n\nFlaky tasks can disrupt your CI pipeline. Automatically retry them with Nx Cloud. Learn more at https://nx.dev/ci/features/flaky-tasks\n"})}),"\n",(0,s.jsx)(n.h3,{id:"11-\u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u043c-\u043c\u0438\u0433\u0440\u0430\u0446\u0438\u0438",children:"11. \u041f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u043c \u043c\u0438\u0433\u0440\u0430\u0446\u0438\u0438"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"\u041a\u043e\u043c\u0430\u043d\u0434\u044b"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm run flyway:migrate\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"\u0412\u044b\u0432\u043e\u0434 \u043a\u043e\u043d\u0441\u043e\u043b\u0438"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ npm run flyway:migrate\n\n> @nestjs-mod-fullstack/source@0.0.0 flyway:migrate\n> ./node_modules/.bin/nx run-many -t=flyway-migrate\n\n\n   \u2714  nx run server:flyway-migrate (1s)\n\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n\n NX   Successfully ran target flyway-migrate for project server (1s)\n\n\n NX   Nx detected a flaky task\n\n  server:flyway-migrate\n\nFlaky tasks can disrupt your CI pipeline. Automatically retry them with Nx Cloud. Learn more at https://nx.dev/ci/features/flaky-tasks\n"})}),"\n",(0,s.jsx)(n.h3,{id:"12-\u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u043c\u0441\u044f-\u043a-\u0431\u0430\u0437\u0435-\u0434\u0430\u043d\u043d\u044b\u0445-\u0438-\u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c-\u0441\u043f\u0438\u0441\u043e\u043a-\u0442\u0430\u0431\u043b\u0438\u0446",children:"12. \u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u043c\u0441\u044f \u043a \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0441\u043f\u0438\u0441\u043e\u043a \u0442\u0430\u0431\u043b\u0438\u0446"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"\u041a\u043e\u043c\u0430\u043d\u0434\u044b"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker exec -it server-postgre-sql psql postgres://app:app_password@localhost:5432/app\n\\d\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"\u0412\u044b\u0432\u043e\u0434 \u043a\u043e\u043d\u0441\u043e\u043b\u0438"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'docker exec -it server-postgre-sql psql postgres://app:app_password@localhost:5432/app\npsql (15.5)\nType "help" for help.\n\napp-> \\d\n public | AppDemo      | table | app\n public | __migrations | table | app\n\napp->\n'})}),"\n",(0,s.jsx)(n.h3,{id:"13-\u043e\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c-\u0431\u0430\u0437\u0443-\u0434\u0430\u043d\u043d\u044b\u0445",children:"13. \u041e\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c \u0431\u0430\u0437\u0443 \u0434\u0430\u043d\u043d\u044b\u0445"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"\u041a\u043e\u043c\u0430\u043d\u0434\u044b"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm run docker-compose:stop-prod:server\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"\u0412\u044b\u0432\u043e\u0434 \u043a\u043e\u043d\u0441\u043e\u043b\u0438"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ npm run docker-compose:stop-prod:server\n\n> @nestjs-mod-fullstack/source@0.0.0 docker-compose:stop-prod:server\n> export COMPOSE_INTERACTIVE_NO_CLI=1 && docker-compose -f ./apps/server/docker-compose-prod.yml --env-file ./apps/server/docker-compose-prod.env down\n\nStopping server-postgre-sql ... done\nRemoving server-postgre-sql ... done\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u0412 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u043c \u043f\u043e\u0441\u0442\u0435 \u044f \u0434\u043e\u0431\u0430\u0432\u043b\u044e \u0432 \u0441\u0435\u0440\u0432\u0435\u0440 \u0440\u0430\u0431\u043e\u0442\u0443 \u0441 \u0431\u0430\u0437\u043e\u0439 \u0434\u0430\u043d\u043d\u044b\u0445 \u0447\u0435\u0440\u0435\u0437 PrismaORM..."}),"\n",(0,s.jsx)(n.h3,{id:"\u0441\u0441\u044b\u043b\u043a\u0438",children:"\u0421\u0441\u044b\u043b\u043a\u0438"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://nestjs.com",children:"https://nestjs.com"})," - \u043e\u0444\u0438\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0439 \u0441\u0430\u0439\u0442 \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u0430"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://nestjs-mod.com",children:"https://nestjs-mod.com"})," - \u043e\u0444\u0438\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0439 \u0441\u0430\u0439\u0442 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u0443\u0442\u0438\u043b\u0438\u0442"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/nestjs-mod/nestjs-mod-fullstack",children:"https://github.com/nestjs-mod/nestjs-mod-fullstack"})," - \u043f\u0440\u043e\u0435\u043a\u0442 \u0438\u0437 \u043f\u043e\u0441\u0442\u0430"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/nestjs-mod/nestjs-mod-fullstack/commit/4661c2f29170568fdf62d3ba0dd4bf20a79a1afa",children:"https://github.com/nestjs-mod/nestjs-mod-fullstack/commit/4661c2f29170568fdf62d3ba0dd4bf20a79a1afa"})," - \u043a\u043e\u043c\u043c\u0438\u0442 \u043d\u0430 \u0442\u0435\u043a\u0443\u0449\u0438\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"#postgres #flyway #nestjsmod #fullstack\n#2024-08-11"})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var s=t(6540);const i={},r=s.createContext(i);function o(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);